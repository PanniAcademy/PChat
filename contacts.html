<!DOCTYPE html>
<html>
<head>
    <title>PChat - Contacts</title>
</head>
<body>
    <h1>Your Contacts</h1>
    <input type="text" id="contactName" placeholder="Enter Name">
    <input type="text" id="contactNumber" placeholder="Enter Phone Number">
    <button onclick="addContact()">Add Contact</button>

    <h2>Saved Contacts</h2>
    <ul id="contactList"></ul>

    <script type="module">
        import { auth, db, collection, addDoc, getDocs } from './firebase.js';

        async function addContact() {
            let name = document.getElementById('contactName').value;
            let number = document.getElementById('contactNumber').value;
            try {
                await addDoc(collection(db, "contacts"), { name, number });
                alert("Contact added!");
                location.reload();
            } catch (error) {
                alert(error.message);
            }
        }

        async function loadContacts() {
            let contacts = await getDocs(collection(db, "contacts"));
            let list = document.getElementById('contactList');
            list.innerHTML = "";
            contacts.forEach(doc => {
                let li = document.createElement('li');
                li.innerHTML = `${doc.data().name} - ${doc.data().number} <button onclick="startChat('${doc.data().number}')">Chat</button>`;
                list.appendChild(li);
            });
        }

        function startChat(number) {
            localStorage.setItem("chatUser", number);
            location.href = "chat.html";
        }

        loadContacts();
    </script>
</body>
</html>
